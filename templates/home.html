{% extends "base.html" %}
{% load static %}
{% block content %}

<div class="d-flex flex-wrap px-4 pt-3 align-items-center">
  <div class="col-6">
   <h1 class="text-success">Welcome To Our Blog Website ðŸŒ¿</h1><br>

    <p><b>
Weâ€™re so glad youâ€™re here! ðŸŽ‰
This space is all about sharing ideas, insights, and stories that inspire learning and spark curiosity. Whether youâ€™re here to explore new perspectives, pick up practical tips, or simply enjoy a good read, youâ€™re in the right place.

Grab a cup of coffee â˜•, take a look around, and feel free to join the conversationâ€”weâ€™d love to hear your thoughts! </b></p>
  </div>
  <div class="col-6">
    <img src="{% static 'logo.jpg' %}" class="img-fluid" style="max-width: 400px; height: auto; float: right; margin-right: 0;" alt="Logo" />
  </div>
</div>

<div class="row p-4">
  <!-- Sidebar -->
  <div class="col-2 p-0">
    <div class="bg-white border rounded shadow-sm p-3 h-100" style="min-height: 350px;">
      <h5>All Category</h5>
      {% for cat in category %}
        <div class="form-check">
          <input class="form-check-input" type="radio" name="category" id="cat-{{cat.id}}" data-url="{% url 'category_wise_post' cat.slug %}">
          <label class="form-check-label" for="cat-{{cat.id}}">
            {{cat.name}}
          </label>
        </div>
      {% endfor %}
    </div>
  </div>

  <!-- Main content -->
  <div class="col-10">
    <h3>{{ data|length }} results found</h3>

    <div class="row g-4 px-4 pt-4">
      {% for post in data %}
      <div class="col-md-3 d-flex">
        <div class="card shadow-lg flex-fill" style="border-radius: 18px; overflow: hidden; display: flex; flex-direction: column;">
          {% if post.image %}
            <img src="{{ post.image.url }}" class="card-img-top" style="height: 160px; object-fit: cover; border-bottom: 2px solid #eee;" alt="Post Image" />
          {% endif %}
          <div class="card-body d-flex flex-column justify-content-start" style="flex: 1 1 auto; background: linear-gradient(135deg, #f8fafc 60%, #e0e7ff 100%);">
            <h5 class="card-title text-danger" style="font-weight: bold; white-space: normal; word-break: break-word;"> <a href="{% url 'detail_post' post.id%}" class="text-decoration-none text-dark" >  {{post.title}} </a>
             
            </h5>

            <!-- Description with View More / Less -->
            <p class="card-text" style="color: #333; white-space: normal; word-break: break-word;">
              <span id="short-{{post.id}}">
                {{ post.content|slice:":200" }}
                {% if post.content|length > 200 %}
                  ... <a href="javascript:void(0);" class="view-more" data-post="{{post.id}}">View More</a>
                {% endif %}
              </span>
              <span id="full-{{post.id}}" style="display:none;">
                {{ post.content }}
                <a href="javascript:void(0);" class="view-less" data-post="{{post.id}}">View Less</a>
              </span>
            </p>

            <p style="font-size: 0.95em; color: #555;">
              Author: <strong>{{post.author.first_name}} {{post.author.last_name}}</strong>
            </p>
            <p>
              Category:
              {% for cat in post.category.all %}
                <button class="btn btn-secondary btn-sm" disabled>{{cat.name}}</button>
              {% endfor %}
            </p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Scripts -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Category filter
        document.querySelectorAll('.form-check-input[name="category"]').forEach(function(input) {
          input.addEventListener('click', function() {
            window.location.href = input.getAttribute('data-url');
          });
        });

        // View more / less toggle
        document.querySelectorAll('.view-more').forEach(function(btn) {
          btn.addEventListener('click', function() {
            var id = this.getAttribute('data-post');
            document.getElementById('short-' + id).style.display = 'none';
            document.getElementById('full-' + id).style.display = 'inline';
          });
        });
        document.querySelectorAll('.view-less').forEach(function(btn) {
          btn.addEventListener('click', function() {
            var id = this.getAttribute('data-post');
            document.getElementById('short-' + id).style.display = 'inline';
            document.getElementById('full-' + id).style.display = 'none';
          });
        });
      });
    </script>
  </div>
</div>

{% endblock %}